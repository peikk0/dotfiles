---
stages:
  - test

include:
  - template: Security/Secret-Detection.gitlab-ci.yml

vint:
  stage: test
  image: alpine:3.17
  script:
    - apk add py3-setuptools vint
    - vint --color --warning .config/vim/vimrc .config/vim/*.vim
  rules:
    - changes:
        - .config/vim/vimrc
        - .config/vim/*.vim

shellcheck:
  stage: test
  image: koalaman/shellcheck-alpine:v0.9.0
  script:
    - |
      shellcheck \
          .config/bash/bashrc \
          .config/sh/profile \
          $(find .config/sh/inc -type f -name '*.sh') \
          .config/X11/xsession \
          .config/yabai/yabairc \
          .config/yadm/bootstrap
  rules:
    - changes:
        - .config/bash/bashrc
          .config/sh/profile
        - .config/sh/inc/*.sh
          .config/X11/xsession
        - .config/yabai/yabairc
        - .config/yadm/bootstrap
