---
stages:
  - test

include:
  - template: Security/Secret-Detection.gitlab-ci.yml

vint:
  stage: test
  image: alpine:3.17
  script:
    - apk add py3-setuptools vint
    - vint --color --warning vim/vimrc vim/*.vim
  rules:
    - changes:
        - vim/vimrc
        - vim/*.vim

shellcheck:
  stage: test
  image: koalaman/shellcheck-alpine:v0.9.0
  script:
    - |
      shellcheck \
          bash/bashrc \
          sh/profile \
          $(find sh/inc -type f -name '*.sh') \
          X11/xsession \
          yabai/yabairc \
          yadm/bootstrap
  rules:
    - changes:
        - bash/bashrc
        - sh/profile
        - sh/inc/*.sh
        - X11/xsession
        - X11/xsessionrc
        - yabai/yabairc
        - yadm/bootstrap
